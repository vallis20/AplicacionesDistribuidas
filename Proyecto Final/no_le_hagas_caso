from flask import Flask, render_template, request
import pymysql

app = Flask(__name__)

# Configuraci칩n de la conexi칩n a la base de datos (reemplaza con tus propios datos)
db = pymysql.connect(
    host='localhost',
    user='tu_usuario',
    password='tu_contrase침a',
    database='nombre_de_tu_base_de_datos',
    charset='utf8mb4',
    cursorclass=pymysql.cursors.DictCursor
)

@app.route('/')
def index():
    return render_template('formulario.html')

@app.route('/procesar_factura', methods=['POST'])
def procesar_factura():
    nombre = request.form['nombre']
    metodo_pago = request.form['metodo_pago']
    numT = request.form['numT']
    total_pagar = request.form['total_pagar']

    try:
        with db.cursor() as cursor:
            # Insertar datos en la tabla Facturacion
            sql = "INSERT INTO Facturacion (usuario_id, total_amount, descripcion, tarjeta) VALUES (%s, %s, %s, %s)"
            cursor.execute(sql, (1, total_pagar, 'Pago de suscripci칩n', numT))  # Cambia '1' por el ID real del usuario
        db.commit()
        return "Datos insertados correctamente"
    except Exception as e:
        return f"Error: {str(e)}"

if __name__ == '__main__':
    app.run(debug=True)
