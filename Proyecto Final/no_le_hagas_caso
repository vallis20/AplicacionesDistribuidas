# Importa la clase BaseDatos
from connectionbd import BaseDatos

# Crea una instancia de la clase
mi_bd = BaseDatos()

# Intenta establecer la conexión
mi_bd.connect()

# Realiza una consulta en una tabla (reemplaza 'NombreDeTuTabla' con el nombre real de tu tabla)
resultados = mi_bd.query_table('Usuarios')

# Crea un archivo HTML para el reporte
with open('reporte_usuarios.html', 'w') as file:
    # Escribe el encabezado del HTML
    file.write('<!DOCTYPE html>\n<html>\n<head>\n<title>Reporte de Usuarios</title>\n</head>\n<body>\n')

    if resultados != 0:
        # Escribe la tabla HTML con los resultados de la consulta
        file.write('<h1>Reporte de Usuarios</h1>\n')
        file.write('<table border="1">\n')
        file.write('<tr><th>ID</th><th>Username</th><th>Email</th><th>Nombre</th><th>Apellido</th><th>Fecha de Registro</th></tr>\n')

        for row in resultados:
            file.write('<tr>')
            file.write(f'<td>{row["usr_id"]}</td>')
            file.write(f'<td>{row["username"]}</td>')
            file.write(f'<td>{row["email"]}</td>')
            file.write(f'<td>{row["nombre"]}</td>')
            file.write(f'<td>{row["apellido"]}</td>')
            file.write(f'<td>{row["fecha_date_registro"]}</td>')
            file.write('</tr>\n')

        file.write('</table>\n')
    else:
        # Si no hay resultados, muestra un mensaje en el HTML
        file.write('<p>No hay resultados para mostrar.</p>\n')

    # Cierra el cuerpo y el HTML
    file.write('</body>\n</html>')

# Cierra la conexión a la base de datos
mi_bd.disconnect()

print("Se ha generado el reporte en 'reporte_usuarios.html'.")
